# machine learning for GPR
This repository contains the code for the machine learning and data pipeline for the Capstone project.
The code is organized in the following way:
```
root directory
│   decision_tree (folder containing the decision tree model)
│   random_forest (folder containing the random forest model)
|   SVM (folder containing the SVM model)
|   CNN (folder containing the CNN model)
|   saved_models (folder containing the saved models)
|   ...
│   data_pipeline.ipynb (data pipeline)
│   validation.ipynb (validation)
│   ...
```
Data pipeline and validation both generate the labels classified by the machine learning models.

The difference between datapipeline and validation is that the output of the data pipeline will be labeled in blue and the output of the validation will be labeled in green (true positive) and red (false positive). The true positive and false positive are determined by comparing the labels generated by the machine learning models and the annotations.

To run the code, please pull this repository and `data_preprocessing` repository to the same directory. The `data_preprocessing` repository can be found [here](https://github.com/MLforGPR/data_preprocessing).

## Overview of Steps
This section provides an overview of the steps required to train and validate the machine learning models. The detailed instructions are provided in the following sections.
1. Train the machine learning models
2. Run the data pipeline
3. Run the validation

## Machine Learning Models
The code of the machine learning models is save in the directory with the name of the model.  
The code is organized in the following way:
```
root directory
│   decision_tree (folder containing the decision tree model)
│   random_forest (folder containing the random forest model)
|   SVM (folder containing the SVM model)
|   CNN (folder containing the CNN model)
|   saved_models (folder containing the saved models)
|   ...
```

Move saved models to the `saved_models` folder after training the models. The saved models will be used by the data pipeline and validation.

## Data Pipeline
This section describes the data pipeline for the Capstone project. The data pipeline is implemented in the Jupyter notebook `data_pipeline_*.ipynb`.  
The data pipeline is organized in the following way:
```
root directory
│   data_pipeline_1st2nddataset.ipynb (final data pipeline for SVM)
│   data_pipeline_1st2nddataset_cnn.ipynb (final data pipeline for CNN)
|   data_pipeline_combined.ipynb (data pipeline for 1st dataset only)
|   data_pipeline_layer.ipynb (data pipeline for detecting top layers)
|   ...
```

### Final Data Pipeline
The final data pipeline is implemented in the Jupyter notebook `data_pipeline_1st2nddataset.ipynb` and `data_pipeline_1st2nddataset_cnn.ipynb`. `data_pipeline_1st2nddataset.ipynb` is the data pipeline for SVM and `data_pipeline_1st2nddataset_cnn.ipynb` is the data pipeline for CNN.

### Previous Data Pipeline
`data_pipeline_combined.ipynb` and `data_pipeline_layer.ipynb` are the data pipeline for the 1st dataset only. They are not capable of handling the 2nd dataset and 3rd dataset.

## Validation
This section describes the validation for the Capstone project. The validation is implemented in the Jupyter notebook `validation.ipynb` and `validation_cnn.ipynb`. `validation.ipynb` is the validation for SVM and `validation_cnn.ipynb` is the validation for CNN. The validation is organized in the following way:
```
root directory
│   validation.ipynb (validation for SVM)
│   validation_cnn.ipynb (validation for CNN)
|   ...
```

This code also contains the code for recording the results of the validation. The results will be saved in the MP4 file `validation.mp4` and `validation_cnn.mp4`.